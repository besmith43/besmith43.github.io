<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Building Custom Profiles" /><meta property="og:locale" content="en" /><meta name="description" content="What is PowerShell" /><meta property="og:description" content="What is PowerShell" /><link rel="canonical" href="https://besmith43.github.io/posts/PS_Profiles/" /><meta property="og:url" content="https://besmith43.github.io/posts/PS_Profiles/" /><meta property="og:site_name" content="BS Tech Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-31T17:00:00-06:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Building Custom Profiles" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-06T20:37:12-05:00","datePublished":"2020-01-31T17:00:00-06:00","description":"What is PowerShell","headline":"Building Custom Profiles","mainEntityOfPage":{"@type":"WebPage","@id":"https://besmith43.github.io/posts/PS_Profiles/"},"url":"https://besmith43.github.io/posts/PS_Profiles/"}</script><title>Building Custom Profiles | BS Tech Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BS Tech Blog"><meta name="application-name" content="BS Tech Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BS Tech Blog</a></div><div class="site-subtitle font-italic">playing with electrified rocks for fun</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/besmith43" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['besmith43','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Building Custom Profiles</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Building Custom Profiles</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/besmith43">Blake Smith</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1580511600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-01-31 </em> </span> <span> Updated <em class="timeago" data-ts="1654565832" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-06 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="783 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><h4 id="what-is-powershell"><span class="mr-2">What is PowerShell</span><a href="#what-is-powershell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>PowerShell started life as a Windows native alternative to bash or unix shell. It was built with the also Microsoft designed .Net Framework using the C# language. It was first introduced in Windows XP. Now in 2020, we have PowerShell version 5.0 and 5.1 in Windows 10, and PowerShell Core that is crossplatform and built with .Net Core. This shell has the ability to automate nearly everything that you'd like a computer to do, but in order to do that, you'll need to make yourself at home with this shell. Customization is the best part of bash and other unix shells, and everyone's shell is different. Even though they have the same pieces to start with. Likewise what you'll see here in my profiles, I have goals and actions that the profile needs to meet. You'll need to use PowerShell for awhile to see what you want from it, but my goal is to walk you through a method to setup your own customizations while following the dry programming methodology.</p><h4 id="where-to-place-the-profile"><span class="mr-2">Where to Place the Profile</span><a href="#where-to-place-the-profile" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>With there being 2 different versions of PowerShell and it being available on at least 3 different operating systems, file placement is paramount to getting things to work as expected. With version 5 (the Windows only version), the profile needs to be placed at <strong>~\Documents\WindowsPowerShell</strong> with the name of <strong>Profile.ps1</strong>. While the Core version needs to be placed at different places depending on the operating system. Because of this I use the PowerShell profile variable of <strong>$profile</strong> to allow PowerShell to place the file where ever it needs to go for the platform I'm on at the moment like so.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span data-label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">test-path</span><span class="w"> </span><span class="nt">-itemtype</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="nt">-path</span><span class="w"> </span><span class="nv">$profile</span><span class="p">))</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="n">new-item</span><span class="w"> </span><span class="nv">$profile</span><span class="w"> </span><span class="nt">-force</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>This will set a blank file at the specific location for your platform. For Windows, this location is <strong>~\Documents\PowerShell</strong> and the file name is <strong>Microsoft.PowerShell_profile.ps1</strong>. Why they do the naming convention like this I have no idea, but with Linux the location is <strong>~/.config/powershell</strong> and the same file name. Please note that all of these detailed locations only place the profile file where it will be loaded under your user account. If you'd like to have a profile that runs for all users on the machine please reference the <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7">Microsoft Documentation</a>.</p><h4 id="now-that-its-placed-what-do-i-do-with-it"><span class="mr-2">Now that it's placed, what do I do with it</span><a href="#now-that-its-placed-what-do-i-do-with-it" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>For anyone who has used and customized a Unix environment, this is easy, but for the average Windows user that doesn't need to use the command line on a daily basis, it's just a blank file and no idea what to put in it. Basically we're just going to start filling it with every custom function, alias, or module import that we want to have available everytime that you open PowerShell. This process is mostly discovery as you find more things that you want to do consistantly and easily or as you find more things that PowerShell can do. I have a blank file setup that you can download to get started <a href="https://github.com/besmith43/Blank-PWSHRC">here</a>.</p><h4 id="looking-at-the-components"><span class="mr-2">Looking at the components</span><a href="#looking-at-the-components" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>If you downloaded my blank profile setup, you'll notice that it is far more than one file. That is because I like to separate concerns. For example, there is a aliases.ps1, and functions.ps1. Both of these files should contain only their namesakes. This way when you need to go back and add something new or modify something, you'll have a precise place to go to. This is the base concept of maintainability and one that will save you a lot of headaches in the future. To get started, the setup is currently hard coded to be stored at <strong>~\Documents\PWSH</strong>. You can change it to where ever you'd like as you get more comfortable with PowerShell and how it works, but for now just place the PWSH folder into your Documents folder. Then from a powershell prompt, run the following command <strong>~\Documents\PWSH\install.ps1</strong>. This will place the PowerShell version 5.0 profile where it needs to go if you're on Windows, and the PowerShell Core profile where it needs to go. These 2 files do nothing but point back to the PWSH folder and more specifically the <strong>pwshrc.ps1</strong>. This script then imports the others at startup of a new shell. The <strong>programs.ps1</strong>, <strong>modules.ps1</strong>, and <strong>variables.ps1</strong> files are currently set as I have them on my personal machines so that you can see what this level of automation can look like, while the <strong>aliases.ps1</strong> and <strong>functions.ps1</strong> files are basically blank. At the end of this article I'll have my full setup available for download as it maybe helpful to see and use a unified setup to get a feel for what is possible.</p><p><a href="https://github.com/besmith43/PWSHRC">My PowerShell Profile</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/powershell/'>powershell</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Building Custom Profiles - BS Tech Blog&amp;url=https://besmith43.github.io/posts/PS_Profiles/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Building Custom Profiles - BS Tech Blog&amp;u=https://besmith43.github.io/posts/PS_Profiles/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://besmith43.github.io/posts/PS_Profiles/&amp;text=Building Custom Profiles - BS Tech Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/RustCrossCompilation/">Cross Compiling Rust on a MacBook</a><li><a href="/posts/VimAllTheThings/">Vim All the Things</a><li><a href="/posts/Py_FirstProgram_pt4/">First Python Program Part 4</a><li><a href="/posts/WifiRegister/">Wifi Register</a><li><a href="/posts/DNC_Variables/">Variables in .Net Core</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cross-compile/">cross compile</a> <a class="post-tag" href="/tags/pyinstaller/">pyinstaller</a> <a class="post-tag" href="/tags/rustup/">rustup</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/RustIntro/"><div class="card-body"> <em class="timeago small" data-ts="1655766000" > 2022-06-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Introduction to the Rust Programming Language</h3><div class="text-muted small"><p> Rust Let’s me be transparent. Rust is the latest programming language to catch my eye and solve a problem that I was encountering. As a member of an IT office, it is incredibly helpful to be abl...</p></div></div></a></div><div class="card"> <a href="/posts/RustCrossCompilation/"><div class="card-body"> <em class="timeago small" data-ts="1655506800" > 2022-06-17 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cross Compiling Rust on a MacBook</h3><div class="text-muted small"><p> Rustup The main tool for installing rust tools! With it, we can install new “toolchains”. Basically, the parts of the rust compiler needed for platform specific compilation. Unfortunately, beca...</p></div></div></a></div><div class="card"> <a href="/posts/VimGettingStarted/"><div class="card-body"> <em class="timeago small" data-ts="1654815600" > 2022-06-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Getting Started with Vim</h3><div class="text-muted small"><p> How to Quit? Because Vim is a modal editor, the first question to answer is how to close it. It’s kind of a meme at this point. However you can close vim by pressing “:q” followed by the enter k...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/DNC_Introduction/" class="btn btn-outline-primary" prompt="Older"><p>Introduction to .Net Core Programming</p></a> <a href="/posts/Py_Introduction/" class="btn btn-outline-primary" prompt="Newer"><p>Introduction to Python Programming</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/besmith43">Blake Smith</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cross-compile/">cross compile</a> <a class="post-tag" href="/tags/pyinstaller/">pyinstaller</a> <a class="post-tag" href="/tags/rustup/">rustup</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
