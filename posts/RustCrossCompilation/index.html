<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Cross Compiling Rust on a MacBook" /><meta property="og:locale" content="en" /><meta name="description" content="Rustup" /><meta property="og:description" content="Rustup" /><link rel="canonical" href="https://besmith43.github.io/posts/RustCrossCompilation/" /><meta property="og:url" content="https://besmith43.github.io/posts/RustCrossCompilation/" /><meta property="og:site_name" content="BS Tech Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-17T18:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cross Compiling Rust on a MacBook" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-23T10:49:11-06:00","datePublished":"2022-06-17T18:00:00-05:00","description":"Rustup","headline":"Cross Compiling Rust on a MacBook","mainEntityOfPage":{"@type":"WebPage","@id":"https://besmith43.github.io/posts/RustCrossCompilation/"},"url":"https://besmith43.github.io/posts/RustCrossCompilation/"}</script><title>Cross Compiling Rust on a MacBook | BS Tech Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="BS Tech Blog"><meta name="application-name" content="BS Tech Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">BS Tech Blog</a></div><div class="site-subtitle font-italic">playing with electrified rocks for fun</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/besmith43" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['besmith43','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Cross Compiling Rust on a MacBook</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Cross Compiling Rust on a MacBook</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/besmith43">Blake Smith</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1655506800" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-06-17 </em> </span> <span> Updated <em class="timeago" data-ts="1671814151" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-12-23 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1272 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h4 id="rustup"><span class="mr-2">Rustup</span><a href="#rustup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>The main tool for installing rust tools! With it, we can install new “toolchains”. Basically, the parts of the rust compiler needed for platform specific compilation. Unfortunately, because of the way that rust compiles our code into a binary, it needs the appropriate C libraries to be able to produce the final binary that we’ll run on a client computer. In this post, we’ll discuss how to setup your MacBook to target several prominent architectures and platforms.</p><h4 id="quick-refresher-on-compiling-programs-in-rust"><span class="mr-2">Quick Refresher on Compiling Programs in Rust</span><a href="#quick-refresher-on-compiling-programs-in-rust" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Rust is an llvm based language and what that means is that the rustc compiler compiles our rust source files down to llvm-ir. IR in this context stands for intermediate representation. Then the normal llvm compilers take that output and compiles it down to architecture specific assembly. Once it becomes assembly, a linker goes through, links all the files together and then compiles it down to both a platform and architecture specific machine code that we refer to as a binary. This binary file is our application in a runnable state that we can distribute to others.</p><h4 id="installing-rustup"><span class="mr-2">Installing Rustup</span><a href="#installing-rustup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Firstly we’ll need to get rustup install on our MacBook. This can be done by going <a href="https://rustup.rs">here</a>, and running the command they have in your terminal.</p><h4 id="mac-x86"><span class="mr-2">Mac x86</span><a href="#mac-x86" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>Now that we have Rustup installed, let’s look at the simplest target for cross compiling our rust programs, Intel equipped Macs. First we’ll need to install the rust toolchain for it with the following command:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rustup target add x86_64-apple-darwin
</pre></table></code></div></div><p>Now we have everything installed, and we just need to tell cargo to use the new tooling. To do so for each build run cargo like so:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cargo build <span class="nt">--target</span> x86_64-apple-darwin
</pre></table></code></div></div><p>However that is a lot to type every time and we like being lazy. So how can we tell cargo to build a particular project without having to type in the target option every time? Make a config file. This file needs to be in a .cargo folder within the same directory as the Cargo.toml file, and you’ll need to put the following text in a config file within it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>[build]
target = "x86_64-apple-darwin"
</pre></table></code></div></div><p>To test that these compiles actually worked, let’s make use of the file command. In case you aren’t already familiar with it, the file command will tell you what kind of file you pass it. When it comes to binaries, it will tell us the cpu architecture and operating system that a binary was compiled for. We can use file to check our binaries with the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>file ./target/x86_64-apple-darwin/debug/&lt;program binary&gt;
</pre></table></code></div></div><p>We should get the following output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>target/x86_64-apple-darwin/debug/&lt;program binary&gt;: Mach-O 64-bit executable x86_64
</pre></table></code></div></div><p>The next thing to do would be to move this file to an Intel processor equipped mac and run it.</p><h4 id="windows-x86"><span class="mr-2">Windows x86</span><a href="#windows-x86" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>What most have probably come here for, let’s up the difficulty to one of the most common platforms, Windows running on Intel and AMD processors. To get started, you’ll need to install mingw-w64. I personally use <a href="https://brew.sh">Homebrew</a>. With it, I can run the following command to install mingw-w64:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>brew <span class="nb">install </span>mingw-w64
</pre></table></code></div></div><p>Then we’ll need into install the rust toolchain. To do that run the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rustup target add x86_64-pc-windows-gnu
</pre></table></code></div></div><p>Then to compile the program with the following:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>cargo build <span class="nt">--target</span> x86_64-pc-windows-gnu
</pre></table></code></div></div><p>Like with the Intel Macs, we can make a config file if the project needs to default to build for the Windows x86 platform.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>[build]
target = "x86_64-pc-windows-gnu"

[target.x86_64-pc-windows-gnu]
linker = "x86_64-w64-mingw32-gcc"
</pre></table></code></div></div><p>This config file is telling cargo that the build process needs to use the Windows options and that the linker is mingw32’s version of gcc. Now you don’t have to use the build section, but the linker section is required. Otherwise, cargo will give you an error that effectively means that it doesn’t have a compile toolchain to compile for the Windows platform.</p><p>Now to check that the binary created shows as a Windows file. The file command’s output should look something like the below.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>target/x86_64-pc-windows-gnu/debug/&lt;program binary&gt;.exe: PE32+ executable (console) x86_64, for MS Windows
</pre></table></code></div></div><h4 id="windows-arm64"><span class="mr-2">Windows Arm64</span><a href="#windows-arm64" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>As of the time of writing this, rustc doesn’t have a toolchain for arm64 Windows gnu. It only has a toolchain for arm64 Windows msvc. Msvc is the Microsoft Visual C compiler. It’s a series of libraries and tools to build Windows native progresses. It’s also a runtime library that needs to exist on a client system. However, mingw is the gnu project’s open source and non-Microsoft C compiler that we can use on MacOS and Linux to make Windows binaries. Until the toolchain is built to target Windows on arm64 within rust using mingw, we have to make Windows on arm64 binaries natively on Windows.</p><h4 id="linux-both-arm64-and-x86"><span class="mr-2">Linux (Both Arm64 and x86)</span><a href="#linux-both-arm64-and-x86" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>For Linux, we build both arm64 and x86 Linux binaries from our Macs without the need for a virtual machine just like we did with Windows x86 binaries. To get started, we’ll need to install compilers, and again I’m using homebrew to do this.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>brew tap messense/macos-cross-toolchains

brew <span class="nb">install </span>x86_64-unknown-linux-gnu

brew <span class="nb">install </span>aarch64-unknown-linux-gnu
</pre></table></code></div></div><p>Where this differs from before with Windows, you’ll need to add the following 4 lines to your shell’s configuration files.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="c"># needed to compile for x86 architecture</span>
<span class="nb">export </span><span class="nv">CC_x86_64_unknown_linux_gnu</span><span class="o">=</span>x86_64-unknown-linux-gnu-gcc
<span class="nb">export </span><span class="nv">CXX_x86_64_unknown_linux_gnu</span><span class="o">=</span>x86_64-unknown-linux-gnu-g++
<span class="nb">export </span><span class="nv">AR_x86_64_unknown_linux_gnu</span><span class="o">=</span>x86_64-unknown-linux-gnu-ar
<span class="nb">export </span><span class="nv">CARGO_TARGET_X86_64_UNKNOWN_LINUX_GNU_LINKER</span><span class="o">=</span>x86_64-unknown-linux-gnu-gcc

<span class="c"># compile rust applications for arm64 linux</span>
<span class="nb">export </span><span class="nv">CC_AARCH64_unknown_linux_gnu</span><span class="o">=</span>aarch64-unknown-linux-gnu-gcc
<span class="nb">export </span><span class="nv">CXX_AARCH64_unknown_linux_gnu</span><span class="o">=</span>aarch64-unknown-linux-gnu-g++
<span class="nb">export </span><span class="nv">AR_AARCH64_unknown_linux_gnu</span><span class="o">=</span>aarch64-unknown-linux-gnu-ar
<span class="nb">export </span><span class="nv">CARGO_TARGET_AARCH64_UNKNOWN_LINUX_GNU_LINKER</span><span class="o">=</span>aarch64-unknown-linux-gnu-gcc
</pre></table></code></div></div><p>Now like before we need to install the appropriate rust toolchains like so:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>rustup target add x86_64-unknown-linux-gnu

rustup target add aarch64-unknown-linux-gnu
</pre></table></code></div></div><p>Following these commands, we can build applications for Linux operating systems on both arm64 and x86 cpu architectures out of our rust projects. This can be done with the cargo build options.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>cargo build <span class="nt">--target</span> x86_64-unknown-linux-gnu

cargo build <span class="nt">--target</span> aarch64-unknown-linux-gnu
</pre></table></code></div></div><p>You can also do the .cargo/config file with the following content:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>[build]
target = "x86_64-unknown-linux-gnu"
</pre></table></code></div></div><p>For the file commands outputs, they should look something like the following examples:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>target/x86_64-unknown-linux-gnu/debug/&lt;program binary&gt;: ELF 64-bit LSB pie executable, x86_64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.16, with debug info, not stripped

target/aarch64-unknown-linux-gnu/debug/&lt;program binary&gt;: ELF 64-bit LSB pie executable, ARM aarch64, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux-aarch64.so.1, for GNU/Linux 3.7.0, with debug info, not stripped
</pre></table></code></div></div><h4 id="checking-the-assembly-and-llvm-ir"><span class="mr-2">Checking the Assembly and LLVM-IR</span><a href="#checking-the-assembly-and-llvm-ir" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>One of the fun things that cargo can do is output the assembly code and LLVM-IR that it generates to a file. This can be a good way to debug, if that becomes necessary, or to compare our cross compilation work. To output those intermediate formats to file, you can use the following commands:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>cargo rustc <span class="nt">--</span> <span class="nt">--emit</span> asm

cargo rustc <span class="nt">--</span> <span class="nt">--emit</span> llvm-ir
</pre></table></code></div></div><p>The output of these commands are stored in &lt;program-name&gt;.s and &lt;program-name&gt;.ll files respectively and are found at <code class="language-plaintext highlighter-rouge">target/x86_64-pc-windows-gnu/deps</code>. When you look for a build on the native platform, you’ll need to look at <code class="language-plaintext highlighter-rouge">target/debug/deps</code> for the same assembly, llvm-ir, and binaries we’ve discussed all throughout this article.</p><h4 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>This is a solid start to cross compilation with rust from a Mac. One last bit of wisdom is to use rustup to list all of the install toolchains on a system.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>rustup target list
</pre></table></code></div></div><p>Enjoy your new found knowledge of Rust!</p><h4 id="reference-links"><span class="mr-2">Reference Links</span><a href="#reference-links" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p><a href="https://stackoverflow.com/questions/70058542/cross-compiling-from-macos-to-windows-not-working-with-rust">Stack-Overflow: cross compiling from macos to windows with rust</a></p><p><a href="https://gist.github.com/Mefistophell/9787e1b6d2d9441c16d2ac79d6a505e6">Github Gist: Mefistophell</a></p><p><a href="https://rust-lang.github.io/rustup/concepts/toolchains.html">Rustup Book: Toolchains</a></p><p><a href="https://rust-lang.github.io/rustup/concepts/components.html">Rustup Book: Components</a></p><p><a href="https://github.com/messense/homebrew-macos-cross-toolchains">Github: Messense/homebrew-macos-cross-toolchains</a></p><p><a href="https://stackoverflow.com/questions/68139162/how-can-i-cross-compile-rust-code-into-intel-assembly-on-an-arm-m1-apple-silicon">Stack Overflow: how can i cross compile rust code into intel assembly on an arm m1 apple silicon</a></p><p><a href="https://patriksvensson.se/posts/2020/05/targeting-arm-for-windows-in-rust">Patrik Svensson: targeting arm for windows in rust</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/rust/'>rust</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/rustup/" class="post-tag no-text-decoration" >rustup</a> <a href="/tags/cross-compile/" class="post-tag no-text-decoration" >cross compile</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cross Compiling Rust on a MacBook - BS Tech Blog&amp;url=https://besmith43.github.io/posts/RustCrossCompilation/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cross Compiling Rust on a MacBook - BS Tech Blog&amp;u=https://besmith43.github.io/posts/RustCrossCompilation/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://besmith43.github.io/posts/RustCrossCompilation/&amp;text=Cross Compiling Rust on a MacBook - BS Tech Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/RustCrossCompilation/">Cross Compiling Rust on a MacBook</a><li><a href="/posts/VimAllTheThings/">Vim All the Things</a><li><a href="/posts/Py_FirstProgram_pt4/">First Python Program Part 4</a><li><a href="/posts/WifiRegister/">Wifi Register</a><li><a href="/posts/DNC_Variables/">Variables in .Net Core</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cross-compile/">cross compile</a> <a class="post-tag" href="/tags/pyinstaller/">pyinstaller</a> <a class="post-tag" href="/tags/rustup/">rustup</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/RustIntro/"><div class="card-body"> <em class="timeago small" data-ts="1655766000" > 2022-06-20 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Introduction to the Rust Programming Language</h3><div class="text-muted small"><p> Rust Let’s me be transparent. Rust is the latest programming language to catch my eye and solve a problem that I was encountering. As a member of an IT office, it is incredibly helpful to be abl...</p></div></div></a></div><div class="card"> <a href="/posts/VimGettingStarted/"><div class="card-body"> <em class="timeago small" data-ts="1654815600" > 2022-06-09 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Getting Started with Vim</h3><div class="text-muted small"><p> How to Quit? Because Vim is a modal editor, the first question to answer is how to close it. It’s kind of a meme at this point. However you can close vim by pressing “:q” followed by the enter k...</p></div></div></a></div><div class="card"> <a href="/posts/VimAllTheThings/"><div class="card-body"> <em class="timeago small" data-ts="1653865200" > 2022-05-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vim All the Things</h3><div class="text-muted small"><p> What is Vim? Vim is a modal text editor. One of the things that makes this complicated user interface great is that it allows the user to capitalize on letting the computer do alot of work for yo...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/VimGettingStarted/" class="btn btn-outline-primary" prompt="Older"><p>Getting Started with Vim</p></a> <a href="/posts/RustIntro/" class="btn btn-outline-primary" prompt="Newer"><p>Introduction to the Rust Programming Language</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/besmith43">Blake Smith</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/cross-compile/">cross compile</a> <a class="post-tag" href="/tags/pyinstaller/">pyinstaller</a> <a class="post-tag" href="/tags/rustup/">rustup</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
